---
title: "Data Analysis"
author: "Gina Yi"
date: '2022-11-20'
output: html_document
---
Libraries Used:
```{r}
library("ggplot2")
library("tidyverse")
library("car")
```

Data Cleaning:
Responses to remove:
"ANXFREQ_A": 7-9
"DEPFREQ_A": 7-9
"PHSTAT_A': 7-9 
"HISPALLP_A":97-99 (None of these values exist in the data set)
"MARSTAT_A": 9
"ORIENT_A": 7-9
```{r}
datUnclean <- read.csv("~/Desktop/PSY4960-Fall2022/PSY4960Project/datUnclean.csv")
dat <- datUnclean
colnames(dat) <- c("x","anxiety","depression","physicalHealth","raceEthnicity", "marital", "sexuality")
dat$anxiety <- ifelse(dat$anxiety >=7, NA, dat$anxiety)
dat$depression <- ifelse(dat$depression >=7, NA, dat$depression)
dat$physicalHealth <- ifelse(dat$physicalHealth >= 7, NA, dat$physicalHealth)
dat$marital <-  ifelse(dat$marital == 9, NA, dat$marital)
dat$sexuality <- ifelse(dat$sexuality >= 7, NA, dat$sexuality)
```

Relevel and Reverse Coding 
```{r}
dat$anxietyRev<-recode(dat$anxiety, "1=5;2=4;3=3;4=2;5=1")
dat$depressionRev<-recode(dat$depression, "1=5;2=4;3=3;4=2;5=1")
dat$physicalHealthRev<-recode(dat$physicalHealth, "1=5;2=4;3=3;4=2;5=1")
levels(dat$raceEthnicity)<-c("Hispanic", "Non-Hispanic White only", "Non-Hispanic Black/African American only", "Non-Hispanic Asian only", "Non-Hispanic AIAN only","AIAN and any other group","Other single and multiple races")
dat$marital<-as.factor(dat$marital)
levels(dat$marital)<-c("Married, spouse present","Married, spouse not present","Married, spouse unknown","Widowed","Divorced","Separated","Never married","Living with partner")
```

```{r}
"Currently Unused"
#dat$physicalHealthRev <- as.ordered(dat$physicalHealth)
#levels(dat$physicalHealthRev) <- rev(levels(dat$physicalHealthRev))

#dat$depressionRev <- as.ordered(dat$depression)
#levels(dat$depressionRev) <- rev(levels(dat$depressionRev))

#dat$anxietyRev<- as.ordered(dat$anxiety)
#levels(dat$anxietyRev)<- rev(levels(dat$anxietyRev))

```


Physical Health Hypotheses:
Individuals with poorer physical health statuses will experience depression more frequently.
```{r}
cor.test(dat$depressionRev, dat$physicalHealthRev, method = "spearman", alterantive = "greater")
ggplot(data = dat, aes(physicalHealthRev, depressionRev)) + geom_point()
```

Individuals with poorer physical health statuses will experience anxiety more frequently.
```{r}
cor.test(dat$physicalHealth, dat$anxiety, method = "spearman", alternative = "greater")
```

Race/Ethnicity Hypotheses:
Individuals of different races will experience different frequencies of depression.
```{r}
kruskal.test(depressionRev ~ raceEthnicity, data= dat)
ggplot(dat, aes(raceEthnicity, depressionRev)) + geom_point()
```

Individuals of different races will experience different frequencies of anxiety.
```{r}
kruskal.test(anxietyRev ~ raceEthnicity, data= dat)
ggplot(dat, aes(raceEthnicity, anxietyRev)) + geom_point()
```

Marital status Hypotheses:
Individuals who are married will experience lower levels of of depression
```{r}
kruskal.test(depressionRev ~ marital, data= dat)
ggplot(dat, aes(depressionRev,color=marital,fill=marital)) + geom_density()
```

Individuals who are married will experience lower levels of of anxiety
```{r}
kruskal.test(anxietyRev ~ marital, data= dat)
ggplot(dat, aes(anxietyRev,color=marital,fill=marital)) + geom_density()
```

